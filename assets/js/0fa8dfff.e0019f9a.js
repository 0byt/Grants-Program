"use strict";(self.webpackChunkgrants=self.webpackChunkgrants||[]).push([[35798],{58968:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>m});var a=n(87462),i=(n(67294),n(3905));n(8209);const o={},s="Parachain Validation Conformance Testing",r={unversionedId:"docs/RFPs/parachain_validation_conformance_testing",id:"docs/RFPs/parachain_validation_conformance_testing",title:"Parachain Validation Conformance Testing",description:"Status:* Open",source:"@site/docs/RFPs/parachain_validation_conformance_testing.md",sourceDirName:"docs/RFPs",slug:"/docs/RFPs/parachain_validation_conformance_testing",permalink:"/docs/RFPs/parachain_validation_conformance_testing",draft:!1,editUrl:"https://github.com/w3f/Grants-Program/edit/master/docs/RFPs/parachain_validation_conformance_testing.md",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"On-chain Quadratic Funding",permalink:"/docs/RFPs/on-chain-quadratic-funding"},next:{title:"PHP Substrate API",permalink:"/docs/RFPs/php-api"}},l={},m=[{value:"Project Description \ud83d\udcc4",id:"project-description-",level:2},{value:"Deliverables \ud83d\udd29",id:"deliverables-",level:2}],c={toc:m},p="wrapper";function d(e){let{components:t,...n}=e;return(0,i.kt)(p,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"parachain-validation-conformance-testing"},"Parachain Validation Conformance Testing"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Status:")," Open"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Proposer:")," ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/bkchr"},"bkchr"))),(0,i.kt)("h2",{id:"project-description-"},"Project Description \ud83d\udcc4"),(0,i.kt)("p",null,"Each Polkadot host implementation that wants to take part in consensus needs to implement the Parachains protocol. Part of the Parachains\nprotocol is the execution of the Parachain Validation Function (",(0,i.kt)("inlineCode",{parentName:"p"},"PVF"),"). The ",(0,i.kt)("inlineCode",{parentName:"p"},"PVF")," is a wasm blob that is required to provide the ",(0,i.kt)("inlineCode",{parentName:"p"},"validate_block"),"\nfunction that takes a fixed set of arguments (part is the proof of validity from a collator), validates the proof of validity and returns (on success) some\ninformation back to the Polkadot host implementation. The ",(0,i.kt)("inlineCode",{parentName:"p"},"PVF")," is a black box for the Polkadot node and it can only use the ",(0,i.kt)("inlineCode",{parentName:"p"},"validate_block")," to\nmake use of it. The execution of these ",(0,i.kt)("inlineCode",{parentName:"p"},"PVF"),"s is required to stay in certain limits to reach consensus across different node implementations,\nnode versions, different hardware configuration and OS configurations. Some of these limits are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A deterministic maximum stack depth. All node implementations should support the same stack depth."),(0,i.kt)("li",{parentName:"ul"},"A deterministic maximum memory. All node implementations should support the same maximum memory usage per ",(0,i.kt)("inlineCode",{parentName:"li"},"PVF")," execution."),(0,i.kt)("li",{parentName:"ul"},"A deterministic maximum execution time. All node implementations should execute a given ",(0,i.kt)("inlineCode",{parentName:"li"},"PVF")," in the same maximum time frame."),(0,i.kt)("li",{parentName:"ul"},"A deterministic compilation/preparation of the ",(0,i.kt)("inlineCode",{parentName:"li"},"PVF"),". All node implementations should compile/prepare a given ",(0,i.kt)("inlineCode",{parentName:"li"},"PVF")," in the same maximum time frame and maximum memory budget.")),(0,i.kt)("p",null,"There are probably a lot of other limits as well. To ensure that all node implementations/versions are staying in these limits it is required\nto have conformance tests. These should include basic execution of valid wasm files over to complex wasm files that ensure that the compilation/preparation\nstays in the given limits and/or helps to define these limits properly across different implementations. "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Useful resources:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://paritytech.github.io/polkadot/book/index.html"},"The Polkadot Parachain Host Implementers' Guide")," "),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/paritytech/polkadot/issues/3211"},"Pre-checking for PVF Compilation time")," ")),(0,i.kt)("h2",{id:"deliverables-"},"Deliverables \ud83d\udd29"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Basic conformance tests that are running valid wasm files"),(0,i.kt)("li",{parentName:"ul"},"Conformance tests that are resulting in running over the limits."),(0,i.kt)("li",{parentName:"ul"},"Fuzzing across different implementations ensuring that all are coming to the same result")),(0,i.kt)("p",null,"This is more some never ending task trying to find issues in different implementations, getting them fixed and searching for new vulnerabilities.\nIn the end these tests should ensure that updating wasm engines, introducing new node implementations\netc can be done in a sane way without hoping for the best."))}d.isMDXComponent=!0}}]);